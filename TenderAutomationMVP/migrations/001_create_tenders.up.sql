-- =====================================================================
-- ðŸ—ƒï¸ Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• Ð¢ÐÐ‘Ð›Ð˜Ð¦Ð« TENDERS - ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²
-- =====================================================================
-- 
-- Ð­Ñ‚Ð° Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð¾ÑÐ½Ð¾Ð²Ð½ÑƒÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ñ…
-- Ð¡Ð»ÐµÐ´ÑƒÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ð¼:
-- 1. Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ñ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ°
-- 2. ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ
-- 3. ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð»Ñ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð¾Ñ‚ Ð½ÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
-- 4. Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
--
-- TODO: ÐŸÑ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ:
-- - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²
-- - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð² Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ñ…  
-- - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¾Ð²
-- - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ email ÐºÐ°Ð¼Ð¿Ð°Ð½Ð¸Ð¹
-- - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸

-- =====================================================================
-- ðŸ“Š ÐžÐ¡ÐÐžÐ’ÐÐÐ¯ Ð¢ÐÐ‘Ð›Ð˜Ð¦Ð TENDERS
-- =====================================================================

CREATE TABLE tenders (
    -- ðŸ”‘ ÐŸÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡
    id SERIAL PRIMARY KEY,
    
    -- ðŸ†” Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð° (Ñ Ð¿Ð»Ð¾Ñ‰Ð°Ð´ÐºÐ¸)
    external_id VARCHAR(100) NOT NULL UNIQUE,
    
    -- ðŸ“ ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚ÐµÐ½Ð´ÐµÑ€Ðµ
    title TEXT NOT NULL,                    -- ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°
    description TEXT,                       -- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°
    
    -- ðŸŒ Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ðµ
    platform VARCHAR(50) NOT NULL,         -- ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° (zakupki, szvo, spb Ð¸ Ñ‚.Ð´.)
    url TEXT,                               -- Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ñ‚ÐµÐ½Ð´ÐµÑ€
    
    -- ðŸ‘¤ Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐµ
    customer TEXT,                          -- ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°
    customer_inn VARCHAR(20),               -- Ð˜ÐÐ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°
    
    -- ðŸ’° Ð¤Ð¸Ð½Ð°Ð½ÑÐ¾Ð²Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
    start_price DECIMAL(15,2),              -- ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ (Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ) Ñ†ÐµÐ½Ð°
    currency VARCHAR(3) DEFAULT 'RUB',      -- Ð’Ð°Ð»ÑŽÑ‚Ð°
    
    -- ðŸ“… Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ñ€Ð°Ð¼ÐºÐ¸
    published_at TIMESTAMP,                 -- Ð”Ð°Ñ‚Ð° Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°
    deadline_at TIMESTAMP,                  -- Ð”ÐµÐ´Ð»Ð°Ð¹Ð½ Ð¿Ð¾Ð´Ð°Ñ‡Ð¸ Ð·Ð°ÑÐ²Ð¾Ðº
    
    -- ðŸ·ï¸ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
    status VARCHAR(20) NOT NULL DEFAULT 'active',  -- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°
    category VARCHAR(100),                  -- ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²/ÑƒÑÐ»ÑƒÐ³
    
    -- ðŸ¤– AI Ð°Ð½Ð°Ð»Ð¸Ð· Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹
    ai_score DECIMAL(3,2),                  -- ÐžÑ†ÐµÐ½ÐºÐ° Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ AI (0.00-1.00)
    ai_recommendation VARCHAR(20),          -- Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ AI (participate/skip/analyze)
    ai_analysis_reason TEXT,                -- ÐžÐ±Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° AI
    ai_analyzed_at TIMESTAMP,               -- Ð”Ð°Ñ‚Ð° Ð°Ð½Ð°Ð»Ð¸Ð·Ð° AI
    
    -- ðŸ“Š Ð¡Ð»ÑƒÐ¶ÐµÐ±Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ
    created_at TIMESTAMP DEFAULT NOW(),     -- Ð”Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°Ð¿Ð¸ÑÐ¸
    updated_at TIMESTAMP DEFAULT NOW(),     -- Ð”Ð°Ñ‚Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ
    
    -- âœ… ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
    CONSTRAINT valid_status 
        CHECK (status IN ('active', 'completed', 'cancelled', 'expired', 'draft')),
    
    CONSTRAINT valid_ai_score 
        CHECK (ai_score IS NULL OR (ai_score >= 0 AND ai_score <= 1)),
    
    CONSTRAINT valid_ai_recommendation 
        CHECK (ai_recommendation IS NULL OR 
               ai_recommendation IN ('participate', 'skip', 'analyze')),
    
    CONSTRAINT valid_currency 
        CHECK (currency IN ('RUB', 'USD', 'EUR')),
    
    CONSTRAINT valid_dates 
        CHECK (published_at IS NULL OR deadline_at IS NULL OR published_at <= deadline_at),
    
    CONSTRAINT positive_price 
        CHECK (start_price IS NULL OR start_price >= 0)
);

-- =====================================================================
-- ðŸš€ Ð˜ÐÐ”Ð•ÐšÐ¡Ð« Ð”Ð›Ð¯ ÐŸÐ ÐžÐ˜Ð—Ð’ÐžÐ”Ð˜Ð¢Ð•Ð›Ð¬ÐÐžÐ¡Ð¢Ð˜
-- =====================================================================

-- ðŸ” Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð½Ð´ÐµÐºÑ Ð¿Ð¾ external_id (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¿Ð¾Ð¸ÑÐº)
CREATE UNIQUE INDEX idx_tenders_external_id ON tenders(external_id);

-- ðŸŒ Ð˜Ð½Ð´ÐµÐºÑ Ð¿Ð¾ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ðµ (Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÑƒ)
CREATE INDEX idx_tenders_platform ON tenders(platform);

-- ðŸ·ï¸ Ð˜Ð½Ð´ÐµÐºÑ Ð¿Ð¾ ÑÑ‚Ð°Ñ‚ÑƒÑÑƒ (Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¼ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ð¼)
CREATE INDEX idx_tenders_status ON tenders(status);

-- ðŸ“… Ð˜Ð½Ð´ÐµÐºÑ Ð¿Ð¾ Ð´ÐµÐ´Ð»Ð°Ð¹Ð½Ñƒ (Ð¿Ð¾Ð¸ÑÐº Ð¸ÑÑ‚ÐµÐºÐ°ÑŽÑ‰Ð¸Ñ… Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²)
CREATE INDEX idx_tenders_deadline ON tenders(deadline_at) 
WHERE deadline_at IS NOT NULL;

-- ðŸ¤– Ð˜Ð½Ð´ÐµÐºÑ Ð¿Ð¾ AI Ð¾Ñ†ÐµÐ½ÐºÐµ (Ð¿Ð¾Ð¸ÑÐº Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ñ‹Ñ… Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²)
CREATE INDEX idx_tenders_ai_score ON tenders(ai_score) 
WHERE ai_score IS NOT NULL;

-- ðŸ“Š Ð¡Ð¾ÑÑ‚Ð°Ð²Ð½Ð¾Ð¹ Ð¸Ð½Ð´ÐµÐºÑ Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ (ÑÑ‚Ð°Ñ‚ÑƒÑ + Ð´Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ)
CREATE INDEX idx_tenders_status_created ON tenders(status, created_at);

-- ðŸ” Ð¡Ð¾ÑÑ‚Ð°Ð²Ð½Ð¾Ð¹ Ð¸Ð½Ð´ÐµÐºÑ Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ð¿Ð¾ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ðµ Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÑƒ
CREATE INDEX idx_tenders_platform_status ON tenders(platform, status);

-- ðŸ“… Ð˜Ð½Ð´ÐµÐºÑ Ð¿Ð¾ Ð´Ð°Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ (ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸)
CREATE INDEX idx_tenders_created_at ON tenders(created_at);

-- ðŸ“ ÐŸÐ¾Ð»Ð½Ð¾Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ Ð¸ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÑŽ (Ð´Ð»Ñ PostgreSQL)
-- TODO: Ð Ð°ÑÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶ÐµÐ½ Ð¿Ð¾Ð»Ð½Ð¾Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº
-- CREATE INDEX idx_tenders_fulltext ON tenders 
-- USING gin(to_tsvector('russian', title || ' ' || COALESCE(description, '')));

-- =====================================================================
-- ðŸ•’ Ð¢Ð Ð˜Ð“Ð“Ð•Ð  Ð”Ð›Ð¯ ÐÐ’Ð¢ÐžÐœÐÐ¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ“Ðž ÐžÐ‘ÐÐžÐ’Ð›Ð•ÐÐ˜Ð¯ updated_at
-- =====================================================================

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ñ updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ language 'plpgsql';

-- Ð¢Ñ€Ð¸Ð³Ð³ÐµÑ€ Ð½Ð° Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ tenders
CREATE TRIGGER trigger_tenders_updated_at
    BEFORE UPDATE ON tenders
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

-- =====================================================================
-- ðŸ“Š ÐšÐžÐœÐœÐ•ÐÐ¢ÐÐ Ð˜Ð˜ Ðš Ð¢ÐÐ‘Ð›Ð˜Ð¦Ð• Ð˜ ÐŸÐžÐ›Ð¯Ðœ (Ð´Ð»Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸)
-- =====================================================================

COMMENT ON TABLE tenders IS 'ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°Ñ…';

COMMENT ON COLUMN tenders.id IS 'Ð’Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ ID Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.external_id IS 'ID Ñ‚ÐµÐ½Ð´ÐµÑ€Ð° Ð½Ð° Ð²Ð½ÐµÑˆÐ½ÐµÐ¹ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ðµ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹)';
COMMENT ON COLUMN tenders.title IS 'ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.description IS 'ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.platform IS 'ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð°-Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº (zakupki.gov.ru Ð¸ Ñ‚.Ð´.)';
COMMENT ON COLUMN tenders.url IS 'ÐŸÑ€ÑÐ¼Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° Ñ‚ÐµÐ½Ð´ÐµÑ€';
COMMENT ON COLUMN tenders.customer IS 'ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸-Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°';
COMMENT ON COLUMN tenders.customer_inn IS 'Ð˜ÐÐ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°';
COMMENT ON COLUMN tenders.start_price IS 'ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ñ†ÐµÐ½Ð°';
COMMENT ON COLUMN tenders.currency IS 'Ð’Ð°Ð»ÑŽÑ‚Ð° Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.published_at IS 'Ð”Ð°Ñ‚Ð° Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.deadline_at IS 'ÐšÑ€Ð°Ð¹Ð½Ð¸Ð¹ ÑÑ€Ð¾Ðº Ð¿Ð¾Ð´Ð°Ñ‡Ð¸ Ð·Ð°ÑÐ²Ð¾Ðº';
COMMENT ON COLUMN tenders.status IS 'Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ Ñ‚ÐµÐ½Ð´ÐµÑ€Ð°';
COMMENT ON COLUMN tenders.category IS 'ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²/ÑƒÑÐ»ÑƒÐ³';
COMMENT ON COLUMN tenders.ai_score IS 'ÐžÑ†ÐµÐ½ÐºÐ° Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ AI (0-1)';
COMMENT ON COLUMN tenders.ai_recommendation IS 'Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ AI Ð¿Ð¾ ÑƒÑ‡Ð°ÑÑ‚Ð¸ÑŽ';
COMMENT ON COLUMN tenders.ai_analysis_reason IS 'ÐžÐ±ÑŠÑÑÐ½ÐµÐ½Ð¸Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ AI';
COMMENT ON COLUMN tenders.ai_analyzed_at IS 'Ð’Ñ€ÐµÐ¼Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° AI';
COMMENT ON COLUMN tenders.created_at IS 'Ð’Ñ€ÐµÐ¼Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°Ð¿Ð¸ÑÐ¸';
COMMENT ON COLUMN tenders.updated_at IS 'Ð’Ñ€ÐµÐ¼Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ';

-- =====================================================================
-- ðŸ“‹ ÐŸÐ Ð˜ÐœÐ•Ð Ð« Ð—ÐÐŸÐ ÐžÐ¡ÐžÐ’ Ð”Ð›Ð¯ Ð¢Ð•Ð¡Ð¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð¯
-- =====================================================================

-- TODO: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

-- 1. ÐŸÐ¾Ð¸ÑÐº Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²:
-- SELECT * FROM tenders WHERE status = 'active' ORDER BY created_at DESC LIMIT 10;

-- 2. ÐŸÐ¾Ð¸ÑÐº Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð² Ñ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ AI Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹:
-- SELECT * FROM tenders WHERE ai_score > 0.8 ORDER BY ai_score DESC;

-- 3. Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¿Ð¾ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð°Ð¼:
-- SELECT platform, COUNT(*), AVG(ai_score) FROM tenders GROUP BY platform;

-- 4. ÐŸÐ¾Ð¸ÑÐº Ð¸ÑÑ‚ÐµÐºÐ°ÑŽÑ‰Ð¸Ñ… Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð²:
-- SELECT * FROM tenders 
-- WHERE deadline_at > NOW() 
--   AND deadline_at <= NOW() + INTERVAL '7 days' 
--   AND status = 'active';

-- =====================================================================
-- âœ… ÐœÐ˜Ð“Ð ÐÐ¦Ð˜Ð¯ Ð—ÐÐ’Ð•Ð Ð¨Ð•ÐÐ
-- =====================================================================

-- Ð­Ñ‚Ð° Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð¿Ð¾Ð»Ð½Ð¾Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð´Ð»Ñ MVP
-- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð´Ð»Ñ:
-- 1. Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ° Ñ‚ÐµÐ½Ð´ÐµÑ€Ð¾Ð² Ð¿Ð¾ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼
-- 2. Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ AI Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
-- 3. ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²
-- 4. Ð‘ÑƒÐ´ÑƒÑ‰ÐµÐ³Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
--
-- Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸:
-- 1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ down Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸ÑŽ
-- 2. Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð¾Ð¼ÐµÐ½Ð½ÑƒÑŽ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Tender Ð² Go
-- 3. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ repository Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†ÐµÐ¹
-- 4. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÑÑ…ÐµÐ¼Ñ‹ Ð‘Ð”